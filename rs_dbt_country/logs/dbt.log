

============================== 2022-11-14 13:25:17.853276 | 51774c94-c02f-4303-a0ce-d48f1b245228 ==============================
[0m13:25:17.853292 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:25:17.853843 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
[0m13:25:17.854175 [debug] [MainThread]: Tracking: tracking
[0m13:25:17.864759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ba9fb370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ba9fb2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5ba9fb2b0>]}
[0m13:25:18.124367 [debug] [MainThread]: Executing "git --help"
[0m13:25:18.129139 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:25:18.129514 [debug] [MainThread]: STDERR: "b''"
[0m13:25:18.130891 [debug] [MainThread]: Acquiring new redshift connection "debug"
[0m13:25:18.131115 [debug] [MainThread]: Using redshift connection "debug"
[0m13:25:18.131249 [debug] [MainThread]: On debug: select 1 as id
[0m13:25:18.131374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:25:18.131529 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:25:18.153392 [debug] [MainThread]: SQL status: SELECT in 0.02 seconds
[0m13:25:18.154906 [debug] [MainThread]: On debug: Close
[0m13:25:18.155603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b8118730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b8118910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5b8118520>]}
[0m13:25:18.155999 [debug] [MainThread]: Flushing usage events
[0m13:25:19.047611 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-11-14 13:26:20.684257 | 32634c68-8990-4626-93e7-d978df33d5ab ==============================
[0m13:26:20.684277 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:26:20.684849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:26:20.685011 [debug] [MainThread]: Tracking: tracking
[0m13:26:20.695868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fa5d7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fa5d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fa5d8e0>]}
[0m13:26:20.744828 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:26:20.745270 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m13:26:20.745650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '32634c68-8990-4626-93e7-d978df33d5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711fa73af0>]}
[0m13:26:20.767445 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:26:20.785554 [debug] [MainThread]: Parsing macros/relations.sql
[0m13:26:20.786616 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:26:20.822882 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m13:26:20.825450 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:26:20.826586 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:26:20.827613 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:26:20.828510 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:26:20.830294 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:26:20.831202 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:26:20.832513 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:26:20.833279 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:26:20.838506 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:26:20.839702 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:26:20.840642 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:26:20.841499 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m13:26:20.842585 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:26:20.845798 [debug] [MainThread]: Parsing macros/relations.sql
[0m13:26:20.847839 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:26:20.881016 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m13:26:20.883829 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:26:20.893140 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:26:20.894970 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:26:20.896860 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:26:20.899212 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:26:20.900230 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:26:20.900996 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m13:26:20.902674 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m13:26:20.905069 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:26:20.906762 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:26:20.908253 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:26:20.909789 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:26:20.911134 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:26:20.912807 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:26:20.914699 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:26:20.916156 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:26:20.918084 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:26:20.919613 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:26:20.920922 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:26:20.922823 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:26:20.924967 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:26:20.926352 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:26:20.929157 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:26:20.930924 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:26:20.932442 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:26:20.935022 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:26:20.936570 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:26:20.937866 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:26:20.947650 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:26:20.951310 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:26:20.953155 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:26:20.954653 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:26:20.956363 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:26:20.958553 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:26:20.960709 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:26:20.964343 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:26:20.974451 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:26:20.978685 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:26:20.981779 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:26:20.986591 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:26:20.989362 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:26:20.996371 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:26:21.010320 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:26:21.030884 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:26:21.051309 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:26:21.059508 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:26:21.071162 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:26:21.080065 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:26:21.081352 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:26:21.082487 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:26:21.083638 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:26:21.085623 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:26:21.089158 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:26:21.095151 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:26:21.100472 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:26:21.108400 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:26:21.111910 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:26:21.116839 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:26:21.124717 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:26:21.126872 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:26:21.138821 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:26:21.159730 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:26:21.169890 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:26:21.172114 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:26:21.186778 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:26:21.209187 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:26:21.219093 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:26:21.243810 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:26:21.246768 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:26:21.269721 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:26:21.287452 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:26:21.303763 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:26:21.306547 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:26:21.309154 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:26:21.315925 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:26:21.732424 [debug] [MainThread]: 1699: static parser successfully parsed countries/get_relevant_details_for_countries.sql
[0m13:26:21.750525 [debug] [MainThread]: 1699: static parser successfully parsed countries/get_countries_by_region.sql
[0m13:26:21.754485 [debug] [MainThread]: 1603: static parser failed on countries/filter_countries_data_by_date.sql
[0m13:26:21.761158 [debug] [MainThread]: 1602: parser fallback to jinja rendering on countries/filter_countries_data_by_date.sql
[0m13:26:21.856422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32634c68-8990-4626-93e7-d978df33d5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f4b6a90>]}
[0m13:26:21.865148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32634c68-8990-4626-93e7-d978df33d5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711faaa100>]}
[0m13:26:21.865502 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:26:21.865851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32634c68-8990-4626-93e7-d978df33d5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f4cb070>]}
[0m13:26:21.867441 [info ] [MainThread]: 
[0m13:26:21.868224 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:26:21.869506 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:26:21.886275 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:26:21.886517 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:26:21.886653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:26:21.886806 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:26:21.907842 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:26:21.908091 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:26:21.908232 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:26:21.946623 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:26:21.960632 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:26:21.962547 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:26:21.976734 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:21.976971 [debug] [MainThread]: On master: BEGIN
[0m13:26:21.977102 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:26:21.977247 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:26:21.997858 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:26:21.998148 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:21.998276 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:26:22.049601 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:26:22.051142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32634c68-8990-4626-93e7-d978df33d5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711f466640>]}
[0m13:26:22.051440 [debug] [MainThread]: On master: ROLLBACK
[0m13:26:22.053042 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:22.053193 [debug] [MainThread]: On master: BEGIN
[0m13:26:22.055911 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:26:22.056088 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.056210 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:22.056324 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.057634 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:26:22.057798 [debug] [MainThread]: On master: Close
[0m13:26:22.058614 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:26:22.058927 [info ] [MainThread]: 
[0m13:26:22.063139 [debug] [Thread-1  ]: Began running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:26:22.063365 [info ] [Thread-1  ]: 1 of 1 START test not_null_get_countries_by_region_region ...................... [RUN]
[0m13:26:22.064128 [debug] [Thread-1  ]: Acquiring new redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:26:22.064285 [debug] [Thread-1  ]: Began compiling node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:26:22.064432 [debug] [Thread-1  ]: Compiling test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:26:22.081788 [debug] [Thread-1  ]: Writing injected SQL for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:26:22.082325 [debug] [Thread-1  ]: finished collecting timing info
[0m13:26:22.082494 [debug] [Thread-1  ]: Began executing node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:26:22.102336 [debug] [Thread-1  ]: Writing runtime sql for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:26:22.102903 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:26:22.103060 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: BEGIN
[0m13:26:22.103183 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:26:22.103324 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:26:22.122465 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:26:22.122740 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:26:22.122871 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "braavos"."public"."get_countries_by_region"
where region is null



      
    ) dbt_internal_test
[0m13:26:22.126112 [debug] [Thread-1  ]: Postgres adapter: Postgres error: relation "public.get_countries_by_region" does not exist

[0m13:26:22.126366 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: ROLLBACK
[0m13:26:22.127889 [debug] [Thread-1  ]: finished collecting timing info
[0m13:26:22.128095 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: Close
[0m13:26:22.128950 [debug] [Thread-1  ]: Database Error in test not_null_get_countries_by_region_region (models/countries/schema.yml)
  relation "public.get_countries_by_region" does not exist
  compiled Code at target/run/rs_dbt_country/models/countries/schema.yml/not_null_get_countries_by_region_region.sql
[0m13:26:22.129202 [error] [Thread-1  ]: 1 of 1 ERROR not_null_get_countries_by_region_region ........................... [[31mERROR[0m in 0.07s]
[0m13:26:22.129710 [debug] [Thread-1  ]: Finished running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:26:22.131517 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:26:22.131791 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:22.131917 [debug] [MainThread]: On master: BEGIN
[0m13:26:22.132033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:26:22.132171 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:26:22.157400 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:26:22.157672 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.157797 [debug] [MainThread]: Using redshift connection "master"
[0m13:26:22.157982 [debug] [MainThread]: On master: COMMIT
[0m13:26:22.159364 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:26:22.159519 [debug] [MainThread]: On master: Close
[0m13:26:22.160280 [info ] [MainThread]: 
[0m13:26:22.160571 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m13:26:22.160886 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:26:22.161044 [debug] [MainThread]: Connection 'test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420' was properly closed.
[0m13:26:22.170216 [info ] [MainThread]: 
[0m13:26:22.170585 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:26:22.170941 [info ] [MainThread]: 
[0m13:26:22.171229 [error] [MainThread]: [33mDatabase Error in test not_null_get_countries_by_region_region (models/countries/schema.yml)[0m
[0m13:26:22.171503 [error] [MainThread]:   relation "public.get_countries_by_region" does not exist
[0m13:26:22.171777 [error] [MainThread]:   compiled Code at target/run/rs_dbt_country/models/countries/schema.yml/not_null_get_countries_by_region_region.sql
[0m13:26:22.172145 [info ] [MainThread]: 
[0m13:26:22.172423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:26:22.172820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711faa5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711eb6b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f711eb6b430>]}
[0m13:26:22.173066 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:27:19.029760 | 45a83083-c055-444a-973a-5fc632f2a936 ==============================
[0m13:27:19.029780 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:27:19.030558 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:27:19.030737 [debug] [MainThread]: Tracking: tracking
[0m13:27:19.041267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e7bc940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e7bca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e7bca30>]}
[0m13:27:19.109387 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:27:19.109616 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:27:19.118262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e6ce8b0>]}
[0m13:27:19.127645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e6b7490>]}
[0m13:27:19.128020 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:27:19.128325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e6b7430>]}
[0m13:27:19.130010 [info ] [MainThread]: 
[0m13:27:19.130812 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:27:19.132049 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos"
[0m13:27:19.148987 [debug] [ThreadPool]: Using redshift connection "list_braavos"
[0m13:27:19.149225 [debug] [ThreadPool]: On list_braavos: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos"} */

    select distinct nspname from pg_namespace
  
[0m13:27:19.149362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:19.149514 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:19.172053 [debug] [ThreadPool]: SQL status: SELECT in 0.02 seconds
[0m13:27:19.173865 [debug] [ThreadPool]: On list_braavos: Close
[0m13:27:19.175927 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:27:19.185778 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:27:19.186145 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:27:19.186276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:27:19.186416 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:19.208291 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:27:19.208557 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:27:19.208682 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:27:19.247290 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:27:19.261379 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:27:19.263170 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:27:19.278276 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:19.278496 [debug] [MainThread]: On master: BEGIN
[0m13:27:19.278621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:27:19.278759 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:19.299329 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:27:19.299578 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:19.299702 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:27:19.351476 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:27:19.353104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53e6ceac0>]}
[0m13:27:19.353504 [debug] [MainThread]: On master: ROLLBACK
[0m13:27:19.355174 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:19.355365 [debug] [MainThread]: On master: BEGIN
[0m13:27:19.358299 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:27:19.358529 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.358648 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:19.358762 [debug] [MainThread]: On master: COMMIT
[0m13:27:19.360121 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:19.360293 [debug] [MainThread]: On master: Close
[0m13:27:19.361094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:27:19.361414 [info ] [MainThread]: 
[0m13:27:19.365653 [debug] [Thread-1  ]: Began running node model.rs_dbt_country.get_countries_by_region
[0m13:27:19.366139 [info ] [Thread-1  ]: 1 of 3 START sql table model public.get_countries_by_region .................... [RUN]
[0m13:27:19.366982 [debug] [Thread-1  ]: Acquiring new redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:19.367212 [debug] [Thread-1  ]: Began compiling node model.rs_dbt_country.get_countries_by_region
[0m13:27:19.367375 [debug] [Thread-1  ]: Compiling model.rs_dbt_country.get_countries_by_region
[0m13:27:19.370565 [debug] [Thread-1  ]: Writing injected SQL for node "model.rs_dbt_country.get_countries_by_region"
[0m13:27:19.370999 [debug] [Thread-1  ]: finished collecting timing info
[0m13:27:19.371174 [debug] [Thread-1  ]: Began executing node model.rs_dbt_country.get_countries_by_region
[0m13:27:19.457039 [debug] [Thread-1  ]: Writing runtime sql for node "model.rs_dbt_country.get_countries_by_region"
[0m13:27:19.457486 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:19.457625 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:27:19.457748 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:27:19.457888 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:19.477369 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:27:19.477624 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:19.477766 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */

  
    

  create  table
    "braavos"."public"."get_countries_by_region__dbt_tmp"
    
    
    
  as (
    with source_data as (
   select * from dbt_countries
)

select * from source_data WHERE region = 'EU'
  );
  
[0m13:27:27.481324 [debug] [Thread-1  ]: SQL status: SELECT in 8.0 seconds
[0m13:27:27.490975 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.491218 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region__dbt_tmp" rename to "get_countries_by_region"
[0m13:27:27.495588 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:27:27.560955 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:27:27.561201 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.561332 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:27:27.604765 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
[0m13:27:27.605282 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.605430 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:27:27.607834 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:27:27.617127 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.617358 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
drop table if exists "braavos"."public"."get_countries_by_region__dbt_backup" cascade
[0m13:27:27.619647 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:27:27.624071 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:27:27.624243 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.624368 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:27:27.632857 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
[0m13:27:27.633134 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:27:27.633257 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:27:27.635147 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:27:27.635835 [debug] [Thread-1  ]: finished collecting timing info
[0m13:27:27.636000 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: ROLLBACK
[0m13:27:27.638083 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: Close
[0m13:27:27.638956 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53d5349a0>]}
[0m13:27:27.639352 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.get_countries_by_region ............... [[32mSELECT[0m in 8.27s]
[0m13:27:27.640341 [debug] [Thread-1  ]: Finished running node model.rs_dbt_country.get_countries_by_region
[0m13:27:27.641431 [debug] [Thread-3  ]: Began running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:27:27.641721 [info ] [Thread-3  ]: 2 of 3 START sql table model public.get_relevant_details_for_countries ......... [RUN]
[0m13:27:27.642802 [debug] [Thread-3  ]: Acquiring new redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:27:27.643823 [debug] [Thread-3  ]: Began compiling node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:27:27.644099 [debug] [Thread-3  ]: Compiling model.rs_dbt_country.get_relevant_details_for_countries
[0m13:27:27.652737 [debug] [Thread-3  ]: Writing injected SQL for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:27:27.656846 [debug] [Thread-3  ]: finished collecting timing info
[0m13:27:27.657112 [debug] [Thread-3  ]: Began executing node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:27:27.691680 [debug] [Thread-3  ]: Writing runtime sql for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:27:27.696231 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:27:27.696460 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:27:27.696583 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:27:27.696725 [debug] [Thread-3  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:27.727398 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
[0m13:27:27.727651 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:27:27.727773 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */

  
    

  create  table
    "braavos"."public"."get_relevant_details_for_countries__dbt_tmp"
    
    
    
  as (
    SELECT name, region, __hevo_ingested_at
 FROM "braavos"."public"."get_countries_by_region"
  );
  
[0m13:27:27.732780 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "__hevo_ingested_at" does not exist in get_countries_by_region

[0m13:27:27.733031 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: ROLLBACK
[0m13:27:27.735598 [debug] [Thread-3  ]: finished collecting timing info
[0m13:27:27.735909 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: Close
[0m13:27:27.737209 [debug] [Thread-3  ]: Database Error in model get_relevant_details_for_countries (models/countries/get_relevant_details_for_countries.sql)
  column "__hevo_ingested_at" does not exist in get_countries_by_region
  compiled Code at target/run/rs_dbt_country/models/countries/get_relevant_details_for_countries.sql
[0m13:27:27.737701 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '45a83083-c055-444a-973a-5fc632f2a936', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53c4b85b0>]}
[0m13:27:27.739298 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model public.get_relevant_details_for_countries  [[31mERROR[0m in 0.10s]
[0m13:27:27.740067 [debug] [Thread-3  ]: Finished running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:27:27.740898 [debug] [Thread-2  ]: Began running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:27:27.741302 [info ] [Thread-2  ]: 3 of 3 SKIP relation public.filter_countries_data_by_date ...................... [[33mSKIP[0m]
[0m13:27:27.741829 [debug] [Thread-2  ]: Finished running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:27:27.746640 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:27:27.747708 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:27.747921 [debug] [MainThread]: On master: BEGIN
[0m13:27:27.748118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:27:27.748618 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:27:27.780182 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:27:27.780499 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.780643 [debug] [MainThread]: Using redshift connection "master"
[0m13:27:27.780764 [debug] [MainThread]: On master: COMMIT
[0m13:27:27.783363 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:27:27.783654 [debug] [MainThread]: On master: Close
[0m13:27:27.784777 [info ] [MainThread]: 
[0m13:27:27.785422 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 8.65 seconds (8.65s).
[0m13:27:27.789139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:27:27.789346 [debug] [MainThread]: Connection 'list_braavos' was properly closed.
[0m13:27:27.789459 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_countries_by_region' was properly closed.
[0m13:27:27.789567 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_relevant_details_for_countries' was properly closed.
[0m13:27:27.808437 [info ] [MainThread]: 
[0m13:27:27.808805 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:27:27.809164 [info ] [MainThread]: 
[0m13:27:27.809448 [error] [MainThread]: [33mDatabase Error in model get_relevant_details_for_countries (models/countries/get_relevant_details_for_countries.sql)[0m
[0m13:27:27.809777 [error] [MainThread]:   column "__hevo_ingested_at" does not exist in get_countries_by_region
[0m13:27:27.810231 [error] [MainThread]:   compiled Code at target/run/rs_dbt_country/models/countries/get_relevant_details_for_countries.sql
[0m13:27:27.810534 [info ] [MainThread]: 
[0m13:27:27.810965 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m13:27:27.811905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53d571100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53d571550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd53d571130>]}
[0m13:27:27.812251 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:28:09.327251 | 067f21de-667f-4ad5-922d-7e592723ef95 ==============================
[0m13:28:09.327271 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:28:09.327840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:28:09.328004 [debug] [MainThread]: Tracking: tracking
[0m13:28:09.338843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fefd7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fefd8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fefd8e0>]}
[0m13:28:09.408865 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:28:09.409113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:28:09.417804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fe19760>]}
[0m13:28:09.427633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fe023d0>]}
[0m13:28:09.428050 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:28:09.428368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fe02310>]}
[0m13:28:09.430323 [info ] [MainThread]: 
[0m13:28:09.431222 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:28:09.432528 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos"
[0m13:28:09.450567 [debug] [ThreadPool]: Using redshift connection "list_braavos"
[0m13:28:09.450817 [debug] [ThreadPool]: On list_braavos: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos"} */

    select distinct nspname from pg_namespace
  
[0m13:28:09.450951 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:28:09.451105 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:09.472725 [debug] [ThreadPool]: SQL status: SELECT in 0.02 seconds
[0m13:28:09.474654 [debug] [ThreadPool]: On list_braavos: Close
[0m13:28:09.476687 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:28:09.487247 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:28:09.487504 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:28:09.487631 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:28:09.487774 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:09.507700 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:28:09.507962 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:28:09.508092 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:28:09.546078 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:28:09.560966 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:28:09.562716 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:28:09.577360 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:09.577603 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.577729 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:28:09.577869 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:09.596937 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:28:09.597199 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:09.597325 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:28:09.647792 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:28:09.649285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0fe19b80>]}
[0m13:28:09.649600 [debug] [MainThread]: On master: ROLLBACK
[0m13:28:09.651416 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:09.651566 [debug] [MainThread]: On master: BEGIN
[0m13:28:09.654400 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:28:09.654562 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.654685 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:09.654800 [debug] [MainThread]: On master: COMMIT
[0m13:28:09.656137 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:28:09.656349 [debug] [MainThread]: On master: Close
[0m13:28:09.657178 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:28:09.657578 [info ] [MainThread]: 
[0m13:28:09.661877 [debug] [Thread-1  ]: Began running node model.rs_dbt_country.get_countries_by_region
[0m13:28:09.662441 [info ] [Thread-1  ]: 1 of 3 START sql table model public.get_countries_by_region .................... [RUN]
[0m13:28:09.663228 [debug] [Thread-1  ]: Acquiring new redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.663409 [debug] [Thread-1  ]: Began compiling node model.rs_dbt_country.get_countries_by_region
[0m13:28:09.663574 [debug] [Thread-1  ]: Compiling model.rs_dbt_country.get_countries_by_region
[0m13:28:09.666431 [debug] [Thread-1  ]: Writing injected SQL for node "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.666818 [debug] [Thread-1  ]: finished collecting timing info
[0m13:28:09.666974 [debug] [Thread-1  ]: Began executing node model.rs_dbt_country.get_countries_by_region
[0m13:28:09.754997 [debug] [Thread-1  ]: Writing runtime sql for node "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.755527 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.755686 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:28:09.755810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:28:09.755955 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:09.775511 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:28:09.775779 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.775909 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */

  
    

  create  table
    "braavos"."public"."get_countries_by_region__dbt_tmp"
    
    
    
  as (
    with source_data as (
   select * from dbt_countries
)

select * from source_data WHERE region = 'EU'
  );
  
[0m13:28:09.910524 [debug] [Thread-1  ]: SQL status: SELECT in 0.13 seconds
[0m13:28:09.919455 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.919701 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region" rename to "get_countries_by_region__dbt_backup"
[0m13:28:09.922026 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:09.925648 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.925880 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region__dbt_tmp" rename to "get_countries_by_region"
[0m13:28:09.928113 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:28:09.963279 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:28:09.963532 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:09.963663 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:28:10.013121 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
[0m13:28:10.013599 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:10.013736 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:28:10.015806 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:10.022825 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:10.023059 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
drop table if exists "braavos"."public"."get_countries_by_region__dbt_backup" cascade
[0m13:28:10.026349 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:28:10.027293 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:28:10.027444 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:10.027567 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:28:10.061036 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:28:10.061308 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:28:10.061433 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:28:10.063186 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:28:10.063848 [debug] [Thread-1  ]: finished collecting timing info
[0m13:28:10.064020 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: ROLLBACK
[0m13:28:10.065417 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: Close
[0m13:28:10.066452 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0f482970>]}
[0m13:28:10.066858 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.get_countries_by_region ............... [[32mSELECT[0m in 0.40s]
[0m13:28:10.067373 [debug] [Thread-1  ]: Finished running node model.rs_dbt_country.get_countries_by_region
[0m13:28:10.068084 [debug] [Thread-3  ]: Began running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:28:10.068349 [info ] [Thread-3  ]: 2 of 3 START sql table model public.get_relevant_details_for_countries ......... [RUN]
[0m13:28:10.069134 [debug] [Thread-3  ]: Acquiring new redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:28:10.069285 [debug] [Thread-3  ]: Began compiling node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:28:10.069424 [debug] [Thread-3  ]: Compiling model.rs_dbt_country.get_relevant_details_for_countries
[0m13:28:10.073154 [debug] [Thread-3  ]: Writing injected SQL for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:28:10.073589 [debug] [Thread-3  ]: finished collecting timing info
[0m13:28:10.073744 [debug] [Thread-3  ]: Began executing node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:28:10.097685 [debug] [Thread-3  ]: Writing runtime sql for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:28:10.098337 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:28:10.098494 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:28:10.098617 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:28:10.098758 [debug] [Thread-3  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:10.116991 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
[0m13:28:10.117265 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:28:10.117395 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */

  
    

  create  table
    "braavos"."public"."get_relevant_details_for_countries__dbt_tmp"
    
    
    
  as (
    SELECT name, region, __hevo_ingested_at
 FROM "braavos"."public"."get_countries_by_region"
  );
  
[0m13:28:10.120885 [debug] [Thread-3  ]: Postgres adapter: Postgres error: column "__hevo_ingested_at" does not exist in get_countries_by_region

[0m13:28:10.121142 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: ROLLBACK
[0m13:28:10.122597 [debug] [Thread-3  ]: finished collecting timing info
[0m13:28:10.122783 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: Close
[0m13:28:10.123616 [debug] [Thread-3  ]: Database Error in model get_relevant_details_for_countries (models/countries/get_relevant_details_for_countries.sql)
  column "__hevo_ingested_at" does not exist in get_countries_by_region
  compiled Code at target/run/rs_dbt_country/models/countries/get_relevant_details_for_countries.sql
[0m13:28:10.123898 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '067f21de-667f-4ad5-922d-7e592723ef95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0c38e7f0>]}
[0m13:28:10.124269 [error] [Thread-3  ]: 2 of 3 ERROR creating sql table model public.get_relevant_details_for_countries  [[31mERROR[0m in 0.06s]
[0m13:28:10.124792 [debug] [Thread-3  ]: Finished running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:28:10.125449 [debug] [Thread-2  ]: Began running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:28:10.125650 [info ] [Thread-2  ]: 3 of 3 SKIP relation public.filter_countries_data_by_date ...................... [[33mSKIP[0m]
[0m13:28:10.126151 [debug] [Thread-2  ]: Finished running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:28:10.127589 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:28:10.127804 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:10.127927 [debug] [MainThread]: On master: BEGIN
[0m13:28:10.128053 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:28:10.128188 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:28:10.153321 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:28:10.153597 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.153724 [debug] [MainThread]: Using redshift connection "master"
[0m13:28:10.153845 [debug] [MainThread]: On master: COMMIT
[0m13:28:10.155318 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:28:10.155507 [debug] [MainThread]: On master: Close
[0m13:28:10.156345 [info ] [MainThread]: 
[0m13:28:10.156741 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m13:28:10.157073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:28:10.157202 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_countries_by_region' was properly closed.
[0m13:28:10.157314 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_relevant_details_for_countries' was properly closed.
[0m13:28:10.166080 [info ] [MainThread]: 
[0m13:28:10.166559 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:28:10.166938 [info ] [MainThread]: 
[0m13:28:10.167225 [error] [MainThread]: [33mDatabase Error in model get_relevant_details_for_countries (models/countries/get_relevant_details_for_countries.sql)[0m
[0m13:28:10.167499 [error] [MainThread]:   column "__hevo_ingested_at" does not exist in get_countries_by_region
[0m13:28:10.167871 [error] [MainThread]:   compiled Code at target/run/rs_dbt_country/models/countries/get_relevant_details_for_countries.sql
[0m13:28:10.168160 [info ] [MainThread]: 
[0m13:28:10.168440 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=1 TOTAL=3
[0m13:28:10.168827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0f4ef970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0f4c1070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7d0f4c19a0>]}
[0m13:28:10.169094 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:31:20.807998 | 77733f5b-1682-4194-aae6-cb02aacd15e7 ==============================
[0m13:31:20.808020 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:31:20.808520 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:31:20.808750 [debug] [MainThread]: Tracking: tracking
[0m13:31:20.819699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7910f4880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7910f4940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7910f4970>]}
[0m13:31:20.891491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m13:31:20.892046 [debug] [MainThread]: Partial parsing: updated file: rs_dbt_country://models/countries/filter_countries_data_by_date.sql
[0m13:31:20.892358 [debug] [MainThread]: Partial parsing: updated file: rs_dbt_country://models/countries/get_relevant_details_for_countries.sql
[0m13:31:20.912740 [debug] [MainThread]: 1603: static parser failed on countries/filter_countries_data_by_date.sql
[0m13:31:20.934865 [debug] [MainThread]: 1602: parser fallback to jinja rendering on countries/filter_countries_data_by_date.sql
[0m13:31:20.937241 [debug] [MainThread]: 1699: static parser successfully parsed countries/get_relevant_details_for_countries.sql
[0m13:31:20.980111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77733f5b-1682-4194-aae6-cb02aacd15e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd790fc6c70>]}
[0m13:31:20.989803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77733f5b-1682-4194-aae6-cb02aacd15e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd791004490>]}
[0m13:31:20.990511 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:31:20.990878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77733f5b-1682-4194-aae6-cb02aacd15e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7910042b0>]}
[0m13:31:20.992408 [info ] [MainThread]: 
[0m13:31:20.993351 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:31:20.994969 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:31:21.012995 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:31:21.013241 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:31:21.013374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:21.013523 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:21.034882 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:31:21.035160 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:31:21.035287 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:31:21.073289 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:31:21.087828 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:31:21.089590 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:31:21.104962 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.105205 [debug] [MainThread]: On master: BEGIN
[0m13:31:21.105334 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:21.105475 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:21.126203 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:31:21.126478 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.126603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:21.178058 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:31:21.179596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77733f5b-1682-4194-aae6-cb02aacd15e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd790f9fb80>]}
[0m13:31:21.179981 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:21.181621 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.181829 [debug] [MainThread]: On master: BEGIN
[0m13:31:21.184699 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:21.184952 [debug] [MainThread]: On master: COMMIT
[0m13:31:21.185078 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.185196 [debug] [MainThread]: On master: COMMIT
[0m13:31:21.186600 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:21.186800 [debug] [MainThread]: On master: Close
[0m13:31:21.187625 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:21.187962 [info ] [MainThread]: 
[0m13:31:21.192748 [debug] [Thread-1  ]: Began running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:31:21.193001 [info ] [Thread-1  ]: 1 of 1 START test not_null_get_countries_by_region_region ...................... [RUN]
[0m13:31:21.193825 [debug] [Thread-1  ]: Acquiring new redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:31:21.194153 [debug] [Thread-1  ]: Began compiling node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:31:21.194316 [debug] [Thread-1  ]: Compiling test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:31:21.213311 [debug] [Thread-1  ]: Writing injected SQL for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:31:21.213786 [debug] [Thread-1  ]: finished collecting timing info
[0m13:31:21.214180 [debug] [Thread-1  ]: Began executing node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:31:21.234801 [debug] [Thread-1  ]: Writing runtime sql for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:31:21.235307 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:31:21.235453 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: BEGIN
[0m13:31:21.235576 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:21.235979 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:21.255406 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:31:21.255683 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:31:21.255834 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "braavos"."public"."get_countries_by_region"
where region is null



      
    ) dbt_internal_test
[0m13:31:21.470899 [debug] [Thread-1  ]: SQL status: SELECT in 0.21 seconds
[0m13:31:21.473343 [debug] [Thread-1  ]: finished collecting timing info
[0m13:31:21.473548 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: ROLLBACK
[0m13:31:21.475425 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: Close
[0m13:31:21.476351 [info ] [Thread-1  ]: 1 of 1 PASS not_null_get_countries_by_region_region ............................ [[32mPASS[0m in 0.28s]
[0m13:31:21.476924 [debug] [Thread-1  ]: Finished running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:31:21.478694 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:31:21.478949 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.479076 [debug] [MainThread]: On master: BEGIN
[0m13:31:21.479192 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:21.479328 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:21.504999 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:31:21.505263 [debug] [MainThread]: On master: COMMIT
[0m13:31:21.505387 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:21.505506 [debug] [MainThread]: On master: COMMIT
[0m13:31:21.506866 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:21.507023 [debug] [MainThread]: On master: Close
[0m13:31:21.507816 [info ] [MainThread]: 
[0m13:31:21.508128 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.51 seconds (0.51s).
[0m13:31:21.508471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:21.508629 [debug] [MainThread]: Connection 'test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420' was properly closed.
[0m13:31:21.517119 [info ] [MainThread]: 
[0m13:31:21.517478 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:31:21.517865 [info ] [MainThread]: 
[0m13:31:21.518225 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:31:21.518654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7910044f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7902142b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd790214400>]}
[0m13:31:21.518978 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:31:28.273294 | 6b5407ca-5565-4671-bfbe-f45f8fa7df29 ==============================
[0m13:31:28.273314 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:31:28.274091 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:31:28.274272 [debug] [MainThread]: Tracking: tracking
[0m13:31:28.285027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dce0c7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dce0c880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dce0c8b0>]}
[0m13:31:28.355053 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:31:28.355306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:31:28.364081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dcd0d730>]}
[0m13:31:28.373818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dce02b20>]}
[0m13:31:28.374282 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 327 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:31:28.374687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dccf62e0>]}
[0m13:31:28.376406 [info ] [MainThread]: 
[0m13:31:28.377276 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:31:28.378717 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos"
[0m13:31:28.396615 [debug] [ThreadPool]: Using redshift connection "list_braavos"
[0m13:31:28.396889 [debug] [ThreadPool]: On list_braavos: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos"} */

    select distinct nspname from pg_namespace
  
[0m13:31:28.397029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:28.397186 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:28.419269 [debug] [ThreadPool]: SQL status: SELECT in 0.02 seconds
[0m13:31:28.421282 [debug] [ThreadPool]: On list_braavos: Close
[0m13:31:28.423648 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:31:28.434719 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:31:28.434962 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:31:28.435089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:31:28.435230 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:28.455933 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:31:28.456227 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:31:28.456354 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:31:28.501658 [debug] [ThreadPool]: SQL status: SELECT in 0.05 seconds
[0m13:31:28.516652 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:31:28.518467 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:31:28.534165 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:28.534421 [debug] [MainThread]: On master: BEGIN
[0m13:31:28.534551 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:31:28.534693 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:28.554915 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:31:28.555206 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:28.555348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:31:28.606863 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:31:28.608319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dcd0db50>]}
[0m13:31:28.608656 [debug] [MainThread]: On master: ROLLBACK
[0m13:31:28.610347 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:28.610493 [debug] [MainThread]: On master: BEGIN
[0m13:31:28.613327 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:31:28.613584 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.613706 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:28.613824 [debug] [MainThread]: On master: COMMIT
[0m13:31:28.615292 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:28.615476 [debug] [MainThread]: On master: Close
[0m13:31:28.616326 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:31:28.616746 [info ] [MainThread]: 
[0m13:31:28.621192 [debug] [Thread-1  ]: Began running node model.rs_dbt_country.get_countries_by_region
[0m13:31:28.621578 [info ] [Thread-1  ]: 1 of 3 START sql table model public.get_countries_by_region .................... [RUN]
[0m13:31:28.622496 [debug] [Thread-1  ]: Acquiring new redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.622681 [debug] [Thread-1  ]: Began compiling node model.rs_dbt_country.get_countries_by_region
[0m13:31:28.622836 [debug] [Thread-1  ]: Compiling model.rs_dbt_country.get_countries_by_region
[0m13:31:28.626214 [debug] [Thread-1  ]: Writing injected SQL for node "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.626669 [debug] [Thread-1  ]: finished collecting timing info
[0m13:31:28.626835 [debug] [Thread-1  ]: Began executing node model.rs_dbt_country.get_countries_by_region
[0m13:31:28.715458 [debug] [Thread-1  ]: Writing runtime sql for node "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.715974 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.716125 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:31:28.716247 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:31:28.716390 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:28.736106 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:31:28.736391 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.736517 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */

  
    

  create  table
    "braavos"."public"."get_countries_by_region__dbt_tmp"
    
    
    
  as (
    with source_data as (
   select * from dbt_countries
)

select * from source_data WHERE region = 'EU'
  );
  
[0m13:31:28.791847 [debug] [Thread-1  ]: SQL status: SELECT in 0.06 seconds
[0m13:31:28.800947 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.801203 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region" rename to "get_countries_by_region__dbt_backup"
[0m13:31:28.803643 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:28.807512 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.807761 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region__dbt_tmp" rename to "get_countries_by_region"
[0m13:31:28.809881 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:28.845250 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:31:28.845497 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.845627 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:31:28.879227 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
[0m13:31:28.879708 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.879843 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:31:28.881959 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:31:28.889287 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.889528 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
drop table if exists "braavos"."public"."get_countries_by_region__dbt_backup" cascade
[0m13:31:28.893055 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:31:28.894215 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:31:28.894410 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.894535 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:31:28.938567 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
[0m13:31:28.938859 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:31:28.938985 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:31:28.940797 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:31:28.941545 [debug] [Thread-1  ]: finished collecting timing info
[0m13:31:28.941733 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: ROLLBACK
[0m13:31:28.943162 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: Close
[0m13:31:28.944122 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dc376970>]}
[0m13:31:28.944565 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.get_countries_by_region ............... [[32mSELECT[0m in 0.32s]
[0m13:31:28.945123 [debug] [Thread-1  ]: Finished running node model.rs_dbt_country.get_countries_by_region
[0m13:31:28.945822 [debug] [Thread-3  ]: Began running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:31:28.946189 [info ] [Thread-3  ]: 2 of 3 START sql table model public.get_relevant_details_for_countries ......... [RUN]
[0m13:31:28.946977 [debug] [Thread-3  ]: Acquiring new redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:28.947122 [debug] [Thread-3  ]: Began compiling node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:31:28.947256 [debug] [Thread-3  ]: Compiling model.rs_dbt_country.get_relevant_details_for_countries
[0m13:31:28.950930 [debug] [Thread-3  ]: Writing injected SQL for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:28.951366 [debug] [Thread-3  ]: finished collecting timing info
[0m13:31:28.951523 [debug] [Thread-3  ]: Began executing node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:31:28.974514 [debug] [Thread-3  ]: Writing runtime sql for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:28.974984 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:28.975124 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:31:28.975246 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:31:28.975382 [debug] [Thread-3  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:28.995450 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
[0m13:31:28.995703 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:28.995826 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */

  
    

  create  table
    "braavos"."public"."get_relevant_details_for_countries__dbt_tmp"
    
    
    
  as (
    SELECT name, region, created_at 
 FROM "braavos"."public"."get_countries_by_region"
  );
  
[0m13:31:29.222073 [debug] [Thread-3  ]: SQL status: SELECT in 0.23 seconds
[0m13:31:29.225542 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.225761 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
alter table "braavos"."public"."get_relevant_details_for_countries__dbt_tmp" rename to "get_relevant_details_for_countries"
[0m13:31:29.228070 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:31:29.230625 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:31:29.230807 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.230931 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:31:29.282808 [debug] [Thread-3  ]: SQL status: COMMIT in 0.05 seconds
[0m13:31:29.283569 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.283706 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:31:29.285491 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:31:29.288626 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.288807 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
drop table if exists "braavos"."public"."get_relevant_details_for_countries__dbt_backup" cascade
[0m13:31:29.290439 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:31:29.291650 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:31:29.291793 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.291913 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:31:29.297780 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
[0m13:31:29.298144 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:31:29.298269 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:31:29.299870 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:31:29.300474 [debug] [Thread-3  ]: finished collecting timing info
[0m13:31:29.300648 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: ROLLBACK
[0m13:31:29.302142 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: Close
[0m13:31:29.303289 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dc2a0be0>]}
[0m13:31:29.303706 [info ] [Thread-3  ]: 2 of 3 OK created sql table model public.get_relevant_details_for_countries .... [[32mSELECT[0m in 0.36s]
[0m13:31:29.304266 [debug] [Thread-3  ]: Finished running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:31:29.304811 [debug] [Thread-2  ]: Began running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:31:29.305173 [info ] [Thread-2  ]: 3 of 3 START sql table model public.filter_countries_data_by_date .............. [RUN]
[0m13:31:29.306175 [debug] [Thread-2  ]: Acquiring new redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:31:29.306357 [debug] [Thread-2  ]: Began compiling node model.rs_dbt_country.filter_countries_data_by_date
[0m13:31:29.306492 [debug] [Thread-2  ]: Compiling model.rs_dbt_country.filter_countries_data_by_date
[0m13:31:29.311604 [debug] [Thread-2  ]: finished collecting timing info
[0m13:31:29.312223 [debug] [Thread-2  ]: Compilation Error in model filter_countries_data_by_date (models/countries/filter_countries_data_by_date.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:31:29.312452 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b5407ca-5565-4671-bfbe-f45f8fa7df29', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dc372310>]}
[0m13:31:29.312804 [error] [Thread-2  ]: 3 of 3 ERROR creating sql table model public.filter_countries_data_by_date ..... [[31mERROR[0m in 0.01s]
[0m13:31:29.313392 [debug] [Thread-2  ]: Finished running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:31:29.315048 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:31:29.315274 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:29.315400 [debug] [MainThread]: On master: BEGIN
[0m13:31:29.315515 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:31:29.315647 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:31:29.336964 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:31:29.337247 [debug] [MainThread]: On master: COMMIT
[0m13:31:29.337370 [debug] [MainThread]: Using redshift connection "master"
[0m13:31:29.337489 [debug] [MainThread]: On master: COMMIT
[0m13:31:29.338846 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:31:29.339024 [debug] [MainThread]: On master: Close
[0m13:31:29.339868 [info ] [MainThread]: 
[0m13:31:29.340162 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m13:31:29.340480 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:31:29.340637 [debug] [MainThread]: Connection 'model.rs_dbt_country.filter_countries_data_by_date' was properly closed.
[0m13:31:29.340748 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_countries_by_region' was properly closed.
[0m13:31:29.340855 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_relevant_details_for_countries' was properly closed.
[0m13:31:29.350322 [info ] [MainThread]: 
[0m13:31:29.350667 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:31:29.351013 [info ] [MainThread]: 
[0m13:31:29.351320 [error] [MainThread]: [33mCompilation Error in model filter_countries_data_by_date (models/countries/filter_countries_data_by_date.sql)[0m
[0m13:31:29.351592 [error] [MainThread]:   'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m13:31:29.351937 [info ] [MainThread]: 
[0m13:31:29.352256 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m13:31:29.352660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dccf37f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dccf6160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58dce0ca60>]}
[0m13:31:29.352908 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:31:46.161148 | e736c63c-5069-47f4-baab-0e7be4e14d31 ==============================
[0m13:31:46.161163 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:31:46.161712 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:31:46.161863 [debug] [MainThread]: Tracking: tracking
[0m13:31:46.172442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40070>]}
[0m13:31:46.172843 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m13:31:46.173300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f411fe40b50>]}
[0m13:31:46.173522 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:32:30.201063 | 199f3871-ec28-4f40-8b59-b70481a7bd03 ==============================
[0m13:32:30.201084 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:32:30.201587 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:32:30.201808 [debug] [MainThread]: Tracking: tracking
[0m13:32:30.212646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b89d0>]}
[0m13:32:30.213386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b89d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b89a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fca918b8a00>]}
[0m13:32:30.213611 [debug] [MainThread]: Flushing usage events
[0m13:32:31.086379 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.


============================== 2022-11-14 13:32:41.688358 | b2381153-6196-4468-8beb-1edff3d76d96 ==============================
[0m13:32:41.688374 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:32:41.688912 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:32:41.689072 [debug] [MainThread]: Tracking: tracking
[0m13:32:41.699850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197c5b2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197c5b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197c5ba90>]}
[0m13:32:41.700661 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-_tx4ke4u'
[0m13:32:41.700973 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:32:41.724740 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:32:41.725319 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:32:41.740232 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:32:41.812638 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:32:42.118351 [info ] [MainThread]:   Installed from version 0.8.6
[0m13:32:42.118729 [info ] [MainThread]:   Updated version available: 0.9.2
[0m13:32:42.119136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'b2381153-6196-4468-8beb-1edff3d76d96', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197c0fa60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197c0f370>]}
[0m13:32:42.119415 [info ] [MainThread]: 
[0m13:32:42.119664 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m13:32:42.120255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197cb3fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197cb3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd197b55f40>]}
[0m13:32:42.120481 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:33:06.219996 | c16c24f3-d321-4873-bf73-dbff50c53841 ==============================
[0m13:33:06.220014 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:33:06.220590 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'deps', 'rpc_method': 'deps', 'indirect_selection': 'eager'}
[0m13:33:06.220761 [debug] [MainThread]: Tracking: tracking
[0m13:33:06.231812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58da9370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58da9850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58da9c10>]}
[0m13:33:06.232669 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-e9tkgfrz'
[0m13:33:06.233039 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:33:06.256788 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:33:06.257564 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:33:06.272911 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:33:06.346518 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:33:07.820137 [info ] [MainThread]:   Installed from version 0.9.2
[0m13:33:07.820559 [info ] [MainThread]:   Up to date!
[0m13:33:07.820964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c16c24f3-d321-4873-bf73-dbff50c53841', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58d5db20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58d5d580>]}
[0m13:33:07.821460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58ca2fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58e080a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2b58ca1f10>]}
[0m13:33:07.821679 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:33:16.798375 | f15fa8fc-b699-458a-90b4-f336cd09f2b1 ==============================
[0m13:33:16.798395 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:33:16.798833 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:33:16.799029 [debug] [MainThread]: Tracking: tracking
[0m13:33:16.809708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e37347880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e37347940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e37347970>]}
[0m13:33:16.866796 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m13:33:16.867217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e373766d0>]}
[0m13:33:16.900411 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:33:16.917857 [debug] [MainThread]: Parsing macros/relations.sql
[0m13:33:16.918810 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:33:16.954066 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m13:33:16.956407 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:33:16.957108 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:33:16.958081 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:33:16.958790 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:33:16.960179 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:33:16.960868 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:33:16.962149 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:33:16.962736 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:33:16.967451 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:33:16.968361 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:33:16.969143 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:33:16.969846 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m13:33:16.970771 [debug] [MainThread]: Parsing macros/catalog.sql
[0m13:33:16.973554 [debug] [MainThread]: Parsing macros/relations.sql
[0m13:33:16.975266 [debug] [MainThread]: Parsing macros/adapters.sql
[0m13:33:17.007645 [debug] [MainThread]: Parsing macros/timestamps.sql
[0m13:33:17.010330 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:33:17.019415 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:33:17.020976 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:33:17.022727 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:33:17.024615 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:33:17.025415 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:33:17.026124 [debug] [MainThread]: Parsing macros/materializations/incremental_strategies.sql
[0m13:33:17.027402 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
[0m13:33:17.029542 [debug] [MainThread]: Parsing macros/utils/right.sql
[0m13:33:17.031115 [debug] [MainThread]: Parsing macros/utils/cast_bool_to_text.sql
[0m13:33:17.032518 [debug] [MainThread]: Parsing macros/utils/position.sql
[0m13:33:17.034114 [debug] [MainThread]: Parsing macros/utils/intersect.sql
[0m13:33:17.035212 [debug] [MainThread]: Parsing macros/utils/replace.sql
[0m13:33:17.036827 [debug] [MainThread]: Parsing macros/utils/safe_cast.sql
[0m13:33:17.038472 [debug] [MainThread]: Parsing macros/utils/concat.sql
[0m13:33:17.039770 [debug] [MainThread]: Parsing macros/utils/date_trunc.sql
[0m13:33:17.041340 [debug] [MainThread]: Parsing macros/utils/escape_single_quotes.sql
[0m13:33:17.042766 [debug] [MainThread]: Parsing macros/utils/literal.sql
[0m13:33:17.043966 [debug] [MainThread]: Parsing macros/utils/datediff.sql
[0m13:33:17.045677 [debug] [MainThread]: Parsing macros/utils/array_construct.sql
[0m13:33:17.047844 [debug] [MainThread]: Parsing macros/utils/except.sql
[0m13:33:17.048959 [debug] [MainThread]: Parsing macros/utils/split_part.sql
[0m13:33:17.051827 [debug] [MainThread]: Parsing macros/utils/hash.sql
[0m13:33:17.053273 [debug] [MainThread]: Parsing macros/utils/array_concat.sql
[0m13:33:17.054797 [debug] [MainThread]: Parsing macros/utils/last_day.sql
[0m13:33:17.057186 [debug] [MainThread]: Parsing macros/utils/length.sql
[0m13:33:17.058704 [debug] [MainThread]: Parsing macros/utils/bool_or.sql
[0m13:33:17.059918 [debug] [MainThread]: Parsing macros/utils/data_types.sql
[0m13:33:17.069140 [debug] [MainThread]: Parsing macros/utils/listagg.sql
[0m13:33:17.072508 [debug] [MainThread]: Parsing macros/utils/dateadd.sql
[0m13:33:17.074510 [debug] [MainThread]: Parsing macros/utils/any_value.sql
[0m13:33:17.075784 [debug] [MainThread]: Parsing macros/utils/array_append.sql
[0m13:33:17.077366 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
[0m13:33:17.079512 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
[0m13:33:17.081536 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
[0m13:33:17.084928 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
[0m13:33:17.094850 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
[0m13:33:17.098886 [debug] [MainThread]: Parsing macros/adapters/schema.sql
[0m13:33:17.102095 [debug] [MainThread]: Parsing macros/adapters/timestamps.sql
[0m13:33:17.107148 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
[0m13:33:17.110282 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
[0m13:33:17.117459 [debug] [MainThread]: Parsing macros/adapters/columns.sql
[0m13:33:17.130973 [debug] [MainThread]: Parsing macros/adapters/apply_grants.sql
[0m13:33:17.150691 [debug] [MainThread]: Parsing macros/adapters/relation.sql
[0m13:33:17.171325 [debug] [MainThread]: Parsing macros/etc/statement.sql
[0m13:33:17.179465 [debug] [MainThread]: Parsing macros/etc/datetime.sql
[0m13:33:17.191414 [debug] [MainThread]: Parsing macros/python_model/python.sql
[0m13:33:17.200158 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
[0m13:33:17.201387 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
[0m13:33:17.202347 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
[0m13:33:17.203427 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
[0m13:33:17.205313 [debug] [MainThread]: Parsing macros/materializations/configs.sql
[0m13:33:17.208881 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
[0m13:33:17.215048 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
[0m13:33:17.220075 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
[0m13:33:17.227650 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
[0m13:33:17.231090 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
[0m13:33:17.235842 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
[0m13:33:17.243585 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
[0m13:33:17.246046 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
[0m13:33:17.257128 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
[0m13:33:17.278781 [debug] [MainThread]: Parsing macros/materializations/models/incremental/strategies.sql
[0m13:33:17.288923 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
[0m13:33:17.291189 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
[0m13:33:17.305695 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
[0m13:33:17.328196 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
[0m13:33:17.337599 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
[0m13:33:17.363013 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
[0m13:33:17.365273 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
[0m13:33:17.388124 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
[0m13:33:17.406237 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
[0m13:33:17.422572 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
[0m13:33:17.425066 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
[0m13:33:17.427650 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
[0m13:33:17.434180 [debug] [MainThread]: Parsing tests/generic/builtin.sql
[0m13:33:17.438364 [debug] [MainThread]: Parsing macros/web/get_url_path.sql
[0m13:33:17.441585 [debug] [MainThread]: Parsing macros/web/get_url_host.sql
[0m13:33:17.444189 [debug] [MainThread]: Parsing macros/web/get_url_parameter.sql
[0m13:33:17.446824 [debug] [MainThread]: Parsing macros/jinja_helpers/slugify.sql
[0m13:33:17.448850 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_time.sql
[0m13:33:17.450759 [debug] [MainThread]: Parsing macros/jinja_helpers/pretty_log_format.sql
[0m13:33:17.452424 [debug] [MainThread]: Parsing macros/jinja_helpers/log_info.sql
[0m13:33:17.453864 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_relation.sql
[0m13:33:17.455481 [debug] [MainThread]: Parsing macros/jinja_helpers/_is_ephemeral.sql
[0m13:33:17.458059 [debug] [MainThread]: Parsing macros/generic_tests/recency.sql
[0m13:33:17.460377 [debug] [MainThread]: Parsing macros/generic_tests/not_constant.sql
[0m13:33:17.462344 [debug] [MainThread]: Parsing macros/generic_tests/accepted_range.sql
[0m13:33:17.465816 [debug] [MainThread]: Parsing macros/generic_tests/cardinality_equality.sql
[0m13:33:17.468584 [debug] [MainThread]: Parsing macros/generic_tests/mutually_exclusive_ranges.sql
[0m13:33:17.481345 [debug] [MainThread]: Parsing macros/generic_tests/not_null_proportion.sql
[0m13:33:17.484820 [debug] [MainThread]: Parsing macros/generic_tests/not_accepted_values.sql
[0m13:33:17.488049 [debug] [MainThread]: Parsing macros/generic_tests/equal_rowcount.sql
[0m13:33:17.490466 [debug] [MainThread]: Parsing macros/generic_tests/expression_is_true.sql
[0m13:33:17.493091 [debug] [MainThread]: Parsing macros/generic_tests/sequential_values.sql
[0m13:33:17.497141 [debug] [MainThread]: Parsing macros/generic_tests/unique_combination_of_columns.sql
[0m13:33:17.501172 [debug] [MainThread]: Parsing macros/generic_tests/at_least_one.sql
[0m13:33:17.502930 [debug] [MainThread]: Parsing macros/generic_tests/test_not_null_where.sql
[0m13:33:17.504823 [debug] [MainThread]: Parsing macros/generic_tests/relationships_where.sql
[0m13:33:17.507824 [debug] [MainThread]: Parsing macros/generic_tests/test_unique_where.sql
[0m13:33:17.510081 [debug] [MainThread]: Parsing macros/generic_tests/equality.sql
[0m13:33:17.515970 [debug] [MainThread]: Parsing macros/generic_tests/fewer_rows_than.sql
[0m13:33:17.518575 [debug] [MainThread]: Parsing macros/sql/star.sql
[0m13:33:17.523956 [debug] [MainThread]: Parsing macros/sql/width_bucket.sql
[0m13:33:17.531294 [debug] [MainThread]: Parsing macros/sql/unpivot.sql
[0m13:33:17.542488 [debug] [MainThread]: Parsing macros/sql/get_table_types_sql.sql
[0m13:33:17.544747 [debug] [MainThread]: Parsing macros/sql/get_relations_by_prefix.sql
[0m13:33:17.549746 [debug] [MainThread]: Parsing macros/sql/get_tables_by_pattern_sql.sql
[0m13:33:17.559492 [debug] [MainThread]: Parsing macros/sql/union.sql
[0m13:33:17.575707 [debug] [MainThread]: Parsing macros/sql/haversine_distance.sql
[0m13:33:17.583754 [debug] [MainThread]: Parsing macros/sql/get_filtered_columns_in_relation.sql
[0m13:33:17.587955 [debug] [MainThread]: Parsing macros/sql/get_tables_by_prefix_sql.sql
[0m13:33:17.590452 [debug] [MainThread]: Parsing macros/sql/nullcheck_table.sql
[0m13:33:17.592658 [debug] [MainThread]: Parsing macros/sql/groupby.sql
[0m13:33:17.594592 [debug] [MainThread]: Parsing macros/sql/nullcheck.sql
[0m13:33:17.596834 [debug] [MainThread]: Parsing macros/sql/pivot.sql
[0m13:33:17.602959 [debug] [MainThread]: Parsing macros/sql/deduplicate.sql
[0m13:33:17.612704 [debug] [MainThread]: Parsing macros/sql/surrogate_key.sql
[0m13:33:17.617659 [debug] [MainThread]: Parsing macros/sql/get_relations_by_pattern.sql
[0m13:33:17.622692 [debug] [MainThread]: Parsing macros/sql/get_query_results_as_dict.sql
[0m13:33:17.625879 [debug] [MainThread]: Parsing macros/sql/get_column_values.sql
[0m13:33:17.634326 [debug] [MainThread]: Parsing macros/sql/generate_series.sql
[0m13:33:17.640262 [debug] [MainThread]: Parsing macros/sql/safe_add.sql
[0m13:33:17.642611 [debug] [MainThread]: Parsing macros/sql/date_spine.sql
[0m13:33:17.648408 [debug] [MainThread]: Parsing macros/cross_db_utils/current_timestamp.sql
[0m13:33:17.654174 [debug] [MainThread]: Parsing macros/cross_db_utils/array_construct.sql
[0m13:33:17.658679 [debug] [MainThread]: Parsing macros/cross_db_utils/array_concat.sql
[0m13:33:17.661570 [debug] [MainThread]: Parsing macros/cross_db_utils/cast_array_to_string.sql
[0m13:33:17.665438 [debug] [MainThread]: Parsing macros/cross_db_utils/array_append.sql
[0m13:33:17.668767 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/right.sql
[0m13:33:17.671470 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/cast_bool_to_text.sql
[0m13:33:17.673271 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/position.sql
[0m13:33:17.675468 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/intersect.sql
[0m13:33:17.677526 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/replace.sql
[0m13:33:17.679747 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/safe_cast.sql
[0m13:33:17.681981 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/concat.sql
[0m13:33:17.683913 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/date_trunc.sql
[0m13:33:17.685975 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datatypes.sql
[0m13:33:17.695730 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/escape_single_quotes.sql
[0m13:33:17.698218 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/literal.sql
[0m13:33:17.700291 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/datediff.sql
[0m13:33:17.702665 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/except.sql
[0m13:33:17.704435 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/xdb_deprecation_warning.sql
[0m13:33:17.706795 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/split_part.sql
[0m13:33:17.709017 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/hash.sql
[0m13:33:17.711189 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/last_day.sql
[0m13:33:17.713373 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/length.sql
[0m13:33:17.715514 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/bool_or.sql
[0m13:33:17.717433 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/listagg.sql
[0m13:33:17.720257 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/dateadd.sql
[0m13:33:17.722680 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/any_value.sql
[0m13:33:17.724573 [debug] [MainThread]: Parsing macros/cross_db_utils/deprecated/identifier.sql
[0m13:33:17.726939 [debug] [MainThread]: Parsing macros/materializations/insert_by_period_materialization.sql
[0m13:33:18.431720 [debug] [MainThread]: 1699: static parser successfully parsed countries/get_relevant_details_for_countries.sql
[0m13:33:18.450324 [debug] [MainThread]: 1699: static parser successfully parsed countries/get_countries_by_region.sql
[0m13:33:18.454583 [debug] [MainThread]: 1603: static parser failed on countries/filter_countries_data_by_date.sql
[0m13:33:18.468875 [warn ] [MainThread]: Warning: the `dateadd` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `dateadd` (no prefix) instead. The rs_dbt_country.filter_countries_data_by_date model triggered this warning.
[0m13:33:18.474103 [debug] [MainThread]: 1602: parser fallback to jinja rendering on countries/filter_countries_data_by_date.sql
[0m13:33:18.644775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e372e12b0>]}
[0m13:33:18.657644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e371cb580>]}
[0m13:33:18.658328 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:33:18.658714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e36c9f370>]}
[0m13:33:18.660199 [info ] [MainThread]: 
[0m13:33:18.661026 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:33:18.662343 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos"
[0m13:33:18.680452 [debug] [ThreadPool]: Using redshift connection "list_braavos"
[0m13:33:18.680696 [debug] [ThreadPool]: On list_braavos: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos"} */

    select distinct nspname from pg_namespace
  
[0m13:33:18.680831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:18.680980 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:18.704193 [debug] [ThreadPool]: SQL status: SELECT in 0.02 seconds
[0m13:33:18.706068 [debug] [ThreadPool]: On list_braavos: Close
[0m13:33:18.707975 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:33:18.718166 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:33:18.718399 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:33:18.718524 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:33:18.718664 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:18.740387 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:33:18.740639 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:33:18.740764 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:33:18.779504 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:33:18.794107 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:33:18.795863 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:33:18.811198 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:18.811436 [debug] [MainThread]: On master: BEGIN
[0m13:33:18.811564 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:33:18.811704 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:18.832548 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:33:18.832804 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:18.832927 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:33:18.884447 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:33:18.886864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e37219e80>]}
[0m13:33:18.887256 [debug] [MainThread]: On master: ROLLBACK
[0m13:33:18.888919 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:18.889125 [debug] [MainThread]: On master: BEGIN
[0m13:33:18.891874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:33:18.892047 [debug] [MainThread]: On master: COMMIT
[0m13:33:18.892173 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:18.892291 [debug] [MainThread]: On master: COMMIT
[0m13:33:18.893660 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:18.893826 [debug] [MainThread]: On master: Close
[0m13:33:18.894665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:33:18.895037 [info ] [MainThread]: 
[0m13:33:18.899330 [debug] [Thread-1  ]: Began running node model.rs_dbt_country.get_countries_by_region
[0m13:33:18.899732 [info ] [Thread-1  ]: 1 of 3 START sql table model public.get_countries_by_region .................... [RUN]
[0m13:33:18.900613 [debug] [Thread-1  ]: Acquiring new redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:18.900827 [debug] [Thread-1  ]: Began compiling node model.rs_dbt_country.get_countries_by_region
[0m13:33:18.900981 [debug] [Thread-1  ]: Compiling model.rs_dbt_country.get_countries_by_region
[0m13:33:18.903882 [debug] [Thread-1  ]: Writing injected SQL for node "model.rs_dbt_country.get_countries_by_region"
[0m13:33:18.904336 [debug] [Thread-1  ]: finished collecting timing info
[0m13:33:18.904512 [debug] [Thread-1  ]: Began executing node model.rs_dbt_country.get_countries_by_region
[0m13:33:18.993558 [debug] [Thread-1  ]: Writing runtime sql for node "model.rs_dbt_country.get_countries_by_region"
[0m13:33:18.994260 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:18.994442 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:33:18.994567 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:33:18.994778 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:19.168055 [debug] [Thread-1  ]: SQL status: BEGIN in 0.17 seconds
[0m13:33:19.168309 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.168434 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */

  
    

  create  table
    "braavos"."public"."get_countries_by_region__dbt_tmp"
    
    
    
  as (
    with source_data as (
   select * from dbt_countries
)

select * from source_data WHERE region = 'EU'
  );
  
[0m13:33:19.223966 [debug] [Thread-1  ]: SQL status: SELECT in 0.06 seconds
[0m13:33:19.233531 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.233768 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region" rename to "get_countries_by_region__dbt_backup"
[0m13:33:19.236119 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:19.240078 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.240271 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region__dbt_tmp" rename to "get_countries_by_region"
[0m13:33:19.242290 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:19.277298 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:33:19.277545 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.277675 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:33:19.313514 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
[0m13:33:19.314080 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.314221 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:33:19.316167 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.324153 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.324396 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
drop table if exists "braavos"."public"."get_countries_by_region__dbt_backup" cascade
[0m13:33:19.327844 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:19.329054 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:33:19.329209 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.329333 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:33:19.379536 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
[0m13:33:19.379811 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:33:19.379933 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:33:19.381724 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.382485 [debug] [Thread-1  ]: finished collecting timing info
[0m13:33:19.382703 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: ROLLBACK
[0m13:33:19.384123 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: Close
[0m13:33:19.385090 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e35c14310>]}
[0m13:33:19.385542 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.get_countries_by_region ............... [[32mSELECT[0m in 0.48s]
[0m13:33:19.386170 [debug] [Thread-1  ]: Finished running node model.rs_dbt_country.get_countries_by_region
[0m13:33:19.386873 [debug] [Thread-3  ]: Began running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:33:19.387134 [info ] [Thread-3  ]: 2 of 3 START sql table model public.get_relevant_details_for_countries ......... [RUN]
[0m13:33:19.387907 [debug] [Thread-3  ]: Acquiring new redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.388061 [debug] [Thread-3  ]: Began compiling node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:33:19.388199 [debug] [Thread-3  ]: Compiling model.rs_dbt_country.get_relevant_details_for_countries
[0m13:33:19.392465 [debug] [Thread-3  ]: Writing injected SQL for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.392913 [debug] [Thread-3  ]: finished collecting timing info
[0m13:33:19.393073 [debug] [Thread-3  ]: Began executing node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:33:19.415726 [debug] [Thread-3  ]: Writing runtime sql for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.416428 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.416579 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:33:19.416698 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:33:19.416836 [debug] [Thread-3  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:19.436169 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
[0m13:33:19.436423 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.436550 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */

  
    

  create  table
    "braavos"."public"."get_relevant_details_for_countries__dbt_tmp"
    
    
    
  as (
    SELECT name, region, created_at 
 FROM "braavos"."public"."get_countries_by_region"
  );
  
[0m13:33:19.484012 [debug] [Thread-3  ]: SQL status: SELECT in 0.05 seconds
[0m13:33:19.488602 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.488823 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
alter table "braavos"."public"."get_relevant_details_for_countries" rename to "get_relevant_details_for_countries__dbt_backup"
[0m13:33:19.491022 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:19.494939 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.495164 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
alter table "braavos"."public"."get_relevant_details_for_countries__dbt_tmp" rename to "get_relevant_details_for_countries"
[0m13:33:19.497200 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:19.499979 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:33:19.500140 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.500262 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:33:19.547017 [debug] [Thread-3  ]: SQL status: COMMIT in 0.05 seconds
[0m13:33:19.547484 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.547613 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:33:19.549486 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.552905 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.553098 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
drop table if exists "braavos"."public"."get_relevant_details_for_countries__dbt_backup" cascade
[0m13:33:19.556315 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:19.557296 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:33:19.557472 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.557595 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:33:19.590436 [debug] [Thread-3  ]: SQL status: COMMIT in 0.03 seconds
[0m13:33:19.590701 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:33:19.590819 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:33:19.592534 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.593141 [debug] [Thread-3  ]: finished collecting timing info
[0m13:33:19.593301 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: ROLLBACK
[0m13:33:19.594659 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: Close
[0m13:33:19.595498 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34334ee0>]}
[0m13:33:19.595882 [info ] [Thread-3  ]: 2 of 3 OK created sql table model public.get_relevant_details_for_countries .... [[32mSELECT[0m in 0.21s]
[0m13:33:19.596416 [debug] [Thread-3  ]: Finished running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:33:19.597012 [debug] [Thread-2  ]: Began running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:33:19.597245 [info ] [Thread-2  ]: 3 of 3 START sql table model public.filter_countries_data_by_date .............. [RUN]
[0m13:33:19.598015 [debug] [Thread-2  ]: Acquiring new redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.598165 [debug] [Thread-2  ]: Began compiling node model.rs_dbt_country.filter_countries_data_by_date
[0m13:33:19.598299 [debug] [Thread-2  ]: Compiling model.rs_dbt_country.filter_countries_data_by_date
[0m13:33:19.604952 [warn ] [Thread-2  ]: Warning: the `dateadd` macro is now provided in dbt Core. It is no longer available in dbt_utils and backwards compatibility will be removed in a future version of the package. Use `dateadd` (no prefix) instead. The rs_dbt_country.filter_countries_data_by_date model triggered this warning.
[0m13:33:19.606215 [debug] [Thread-2  ]: Writing injected SQL for node "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.606524 [debug] [Thread-2  ]: finished collecting timing info
[0m13:33:19.606675 [debug] [Thread-2  ]: Began executing node model.rs_dbt_country.filter_countries_data_by_date
[0m13:33:19.628689 [debug] [Thread-2  ]: Writing runtime sql for node "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.629142 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.629281 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:33:19.629403 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m13:33:19.629539 [debug] [Thread-2  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:19.648304 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
[0m13:33:19.648587 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.648712 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */

  
    

  create  table
    "braavos"."public"."filter_countries_data_by_date__dbt_tmp"
    
    
    
  as (
    SELECT * FROM "braavos"."public"."get_relevant_details_for_countries"
WHERE created_at > extract(epoch from 

    dateadd(
        day,
        2,
        '2022-06-27'
        )

)
  );
  
[0m13:33:19.795306 [debug] [Thread-2  ]: SQL status: SELECT in 0.15 seconds
[0m13:33:19.799624 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.799845 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */
alter table "braavos"."public"."filter_countries_data_by_date__dbt_tmp" rename to "filter_countries_data_by_date"
[0m13:33:19.802240 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:33:19.804682 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:33:19.804912 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.805039 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:33:19.838488 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
[0m13:33:19.839042 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.839201 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:33:19.840963 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.844119 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.844326 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */
drop table if exists "braavos"."public"."filter_countries_data_by_date__dbt_backup" cascade
[0m13:33:19.846015 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:33:19.846897 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:33:19.847036 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.847154 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:33:19.853079 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
[0m13:33:19.853352 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:33:19.853473 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:33:19.855124 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:33:19.855809 [debug] [Thread-2  ]: finished collecting timing info
[0m13:33:19.855973 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: ROLLBACK
[0m13:33:19.857336 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: Close
[0m13:33:19.858307 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f15fa8fc-b699-458a-90b4-f336cd09f2b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e34320070>]}
[0m13:33:19.858707 [info ] [Thread-2  ]: 3 of 3 OK created sql table model public.filter_countries_data_by_date ......... [[32mSELECT[0m in 0.26s]
[0m13:33:19.859222 [debug] [Thread-2  ]: Finished running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:33:19.860788 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:33:19.861016 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:19.861140 [debug] [MainThread]: On master: BEGIN
[0m13:33:19.861256 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:33:19.861387 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:33:19.886634 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:33:19.886920 [debug] [MainThread]: On master: COMMIT
[0m13:33:19.887044 [debug] [MainThread]: Using redshift connection "master"
[0m13:33:19.887160 [debug] [MainThread]: On master: COMMIT
[0m13:33:19.888548 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:33:19.888708 [debug] [MainThread]: On master: Close
[0m13:33:19.889534 [info ] [MainThread]: 
[0m13:33:19.889871 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m13:33:19.890249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:33:19.890397 [debug] [MainThread]: Connection 'model.rs_dbt_country.filter_countries_data_by_date' was properly closed.
[0m13:33:19.890510 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_countries_by_region' was properly closed.
[0m13:33:19.890618 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_relevant_details_for_countries' was properly closed.
[0m13:33:19.904443 [info ] [MainThread]: 
[0m13:33:19.904804 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:33:19.905185 [info ] [MainThread]: 
[0m13:33:19.905458 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:33:19.906075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e36cbd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3433b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9e3433b070>]}
[0m13:33:19.906427 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:35:34.223774 | 55a30487-153f-4084-b7d8-d65075f552b7 ==============================
[0m13:35:34.223796 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:35:34.224366 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
[0m13:35:34.224525 [debug] [MainThread]: Tracking: tracking
[0m13:35:34.235249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c03970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c030d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c03a60>]}
[0m13:35:34.332657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:35:34.333220 [debug] [MainThread]: Partial parsing: updated file: rs_dbt_country://models/countries/filter_countries_data_by_date.sql
[0m13:35:34.355377 [debug] [MainThread]: 1603: static parser failed on countries/filter_countries_data_by_date.sql
[0m13:35:34.381117 [debug] [MainThread]: 1602: parser fallback to jinja rendering on countries/filter_countries_data_by_date.sql
[0m13:35:34.424263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3a09580>]}
[0m13:35:34.438286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c393a0>]}
[0m13:35:34.438682 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:35:34.439003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3a0d580>]}
[0m13:35:34.440590 [info ] [MainThread]: 
[0m13:35:34.441428 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:35:34.442882 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos"
[0m13:35:34.460703 [debug] [ThreadPool]: Using redshift connection "list_braavos"
[0m13:35:34.460954 [debug] [ThreadPool]: On list_braavos: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos"} */

    select distinct nspname from pg_namespace
  
[0m13:35:34.461089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:34.461242 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:34.485483 [debug] [ThreadPool]: SQL status: SELECT in 0.02 seconds
[0m13:35:34.487420 [debug] [ThreadPool]: On list_braavos: Close
[0m13:35:34.489480 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:35:34.499909 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:35:34.500153 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:35:34.500284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:35:34.500427 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:34.520376 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:35:34.520629 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:35:34.520756 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:35:34.557571 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:35:34.572336 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:35:34.573968 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:35:34.589304 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:34.589549 [debug] [MainThread]: On master: BEGIN
[0m13:35:34.589677 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:34.589820 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:34.608087 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:35:34.608349 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:34.608476 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:35:34.658327 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:35:34.659773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f39dbb50>]}
[0m13:35:34.660087 [debug] [MainThread]: On master: ROLLBACK
[0m13:35:34.661534 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:34.661699 [debug] [MainThread]: On master: BEGIN
[0m13:35:34.664489 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:35:34.664755 [debug] [MainThread]: On master: COMMIT
[0m13:35:34.664880 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:34.664995 [debug] [MainThread]: On master: COMMIT
[0m13:35:34.666355 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:34.666572 [debug] [MainThread]: On master: Close
[0m13:35:34.667482 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:34.667909 [info ] [MainThread]: 
[0m13:35:34.672212 [debug] [Thread-1  ]: Began running node model.rs_dbt_country.get_countries_by_region
[0m13:35:34.672587 [info ] [Thread-1  ]: 1 of 3 START sql table model public.get_countries_by_region .................... [RUN]
[0m13:35:34.673418 [debug] [Thread-1  ]: Acquiring new redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.673608 [debug] [Thread-1  ]: Began compiling node model.rs_dbt_country.get_countries_by_region
[0m13:35:34.673762 [debug] [Thread-1  ]: Compiling model.rs_dbt_country.get_countries_by_region
[0m13:35:34.676883 [debug] [Thread-1  ]: Writing injected SQL for node "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.677324 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:34.677485 [debug] [Thread-1  ]: Began executing node model.rs_dbt_country.get_countries_by_region
[0m13:35:34.768075 [debug] [Thread-1  ]: Writing runtime sql for node "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.768574 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.768716 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:35:34.768838 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:34.768977 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:34.788273 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:35:34.788543 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.788670 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */

  
    

  create  table
    "braavos"."public"."get_countries_by_region__dbt_tmp"
    
    
    
  as (
    with source_data as (
   select * from dbt_countries
)

select * from source_data WHERE region = 'EU'
  );
  
[0m13:35:34.843827 [debug] [Thread-1  ]: SQL status: SELECT in 0.06 seconds
[0m13:35:34.853742 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.854154 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region" rename to "get_countries_by_region__dbt_backup"
[0m13:35:34.856459 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:34.860764 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.860991 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
alter table "braavos"."public"."get_countries_by_region__dbt_tmp" rename to "get_countries_by_region"
[0m13:35:34.863012 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:34.898415 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:35:34.898678 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.898810 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:35:34.951173 [debug] [Thread-1  ]: SQL status: COMMIT in 0.05 seconds
[0m13:35:34.951660 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.951798 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:35:34.953808 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:34.961416 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.961666 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_countries_by_region"} */
drop table if exists "braavos"."public"."get_countries_by_region__dbt_backup" cascade
[0m13:35:34.965160 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:35:34.966488 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:35:34.966685 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:34.966827 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: COMMIT
[0m13:35:35.011453 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
[0m13:35:35.011729 [debug] [Thread-1  ]: Using redshift connection "model.rs_dbt_country.get_countries_by_region"
[0m13:35:35.011853 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: BEGIN
[0m13:35:35.013562 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:35.014310 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:35.014480 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: ROLLBACK
[0m13:35:35.015869 [debug] [Thread-1  ]: On model.rs_dbt_country.get_countries_by_region: Close
[0m13:35:35.016759 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3fda700>]}
[0m13:35:35.017154 [info ] [Thread-1  ]: 1 of 3 OK created sql table model public.get_countries_by_region ............... [[32mSELECT[0m in 0.34s]
[0m13:35:35.017679 [debug] [Thread-1  ]: Finished running node model.rs_dbt_country.get_countries_by_region
[0m13:35:35.018495 [debug] [Thread-3  ]: Began running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:35:35.018755 [info ] [Thread-3  ]: 2 of 3 START sql table model public.get_relevant_details_for_countries ......... [RUN]
[0m13:35:35.019586 [debug] [Thread-3  ]: Acquiring new redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.019742 [debug] [Thread-3  ]: Began compiling node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:35:35.019878 [debug] [Thread-3  ]: Compiling model.rs_dbt_country.get_relevant_details_for_countries
[0m13:35:35.024043 [debug] [Thread-3  ]: Writing injected SQL for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.024520 [debug] [Thread-3  ]: finished collecting timing info
[0m13:35:35.024689 [debug] [Thread-3  ]: Began executing node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:35:35.048623 [debug] [Thread-3  ]: Writing runtime sql for node "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.049091 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.049234 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:35:35.049354 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m13:35:35.049489 [debug] [Thread-3  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:35.068420 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
[0m13:35:35.068691 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.068821 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */

  
    

  create  table
    "braavos"."public"."get_relevant_details_for_countries__dbt_tmp"
    
    
    
  as (
    SELECT name, region, created_at 
 FROM "braavos"."public"."get_countries_by_region"
  );
  
[0m13:35:35.104590 [debug] [Thread-3  ]: SQL status: SELECT in 0.04 seconds
[0m13:35:35.109099 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.109326 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
alter table "braavos"."public"."get_relevant_details_for_countries" rename to "get_relevant_details_for_countries__dbt_backup"
[0m13:35:35.111646 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:35.115457 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.115674 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
alter table "braavos"."public"."get_relevant_details_for_countries__dbt_tmp" rename to "get_relevant_details_for_countries"
[0m13:35:35.117779 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:35.120900 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:35:35.121130 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.121258 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:35:35.156252 [debug] [Thread-3  ]: SQL status: COMMIT in 0.03 seconds
[0m13:35:35.156716 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.156852 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:35:35.158822 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:35.162355 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.162568 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.get_relevant_details_for_countries"} */
drop table if exists "braavos"."public"."get_relevant_details_for_countries__dbt_backup" cascade
[0m13:35:35.165816 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:35:35.166917 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:35:35.167122 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.167245 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: COMMIT
[0m13:35:35.197390 [debug] [Thread-3  ]: SQL status: COMMIT in 0.03 seconds
[0m13:35:35.197661 [debug] [Thread-3  ]: Using redshift connection "model.rs_dbt_country.get_relevant_details_for_countries"
[0m13:35:35.197788 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: BEGIN
[0m13:35:35.199752 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:35.200466 [debug] [Thread-3  ]: finished collecting timing info
[0m13:35:35.200658 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: ROLLBACK
[0m13:35:35.202303 [debug] [Thread-3  ]: On model.rs_dbt_country.get_relevant_details_for_countries: Close
[0m13:35:35.203224 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3f62670>]}
[0m13:35:35.203630 [info ] [Thread-3  ]: 2 of 3 OK created sql table model public.get_relevant_details_for_countries .... [[32mSELECT[0m in 0.18s]
[0m13:35:35.204192 [debug] [Thread-3  ]: Finished running node model.rs_dbt_country.get_relevant_details_for_countries
[0m13:35:35.204851 [debug] [Thread-2  ]: Began running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:35:35.205141 [info ] [Thread-2  ]: 3 of 3 START sql table model public.filter_countries_data_by_date .............. [RUN]
[0m13:35:35.206089 [debug] [Thread-2  ]: Acquiring new redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.206267 [debug] [Thread-2  ]: Began compiling node model.rs_dbt_country.filter_countries_data_by_date
[0m13:35:35.206404 [debug] [Thread-2  ]: Compiling model.rs_dbt_country.filter_countries_data_by_date
[0m13:35:35.211906 [debug] [Thread-2  ]: Writing injected SQL for node "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.212422 [debug] [Thread-2  ]: finished collecting timing info
[0m13:35:35.212603 [debug] [Thread-2  ]: Began executing node model.rs_dbt_country.filter_countries_data_by_date
[0m13:35:35.235174 [debug] [Thread-2  ]: Writing runtime sql for node "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.235646 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.235785 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:35:35.235904 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m13:35:35.236039 [debug] [Thread-2  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:35.258415 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
[0m13:35:35.258718 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.258852 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */

  
    

  create  table
    "braavos"."public"."filter_countries_data_by_date__dbt_tmp"
    
    
    
  as (
    SELECT * FROM "braavos"."public"."get_relevant_details_for_countries"
WHERE created_at > extract(epoch from 

    dateadd(
        day,
        2,
        '2022-06-27'
        )

)
  );
  
[0m13:35:35.295661 [debug] [Thread-2  ]: SQL status: SELECT in 0.04 seconds
[0m13:35:35.300109 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.300334 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */
alter table "braavos"."public"."filter_countries_data_by_date" rename to "filter_countries_data_by_date__dbt_backup"
[0m13:35:35.302581 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:35.307931 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.308157 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */
alter table "braavos"."public"."filter_countries_data_by_date__dbt_tmp" rename to "filter_countries_data_by_date"
[0m13:35:35.310242 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
[0m13:35:35.312980 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:35:35.313356 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.313538 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:35:35.359408 [debug] [Thread-2  ]: SQL status: COMMIT in 0.05 seconds
[0m13:35:35.359922 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.360063 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:35:35.361997 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:35.365534 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.365758 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "model.rs_dbt_country.filter_countries_data_by_date"} */
drop table if exists "braavos"."public"."filter_countries_data_by_date__dbt_backup" cascade
[0m13:35:35.369217 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
[0m13:35:35.370420 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:35:35.370612 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.370736 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: COMMIT
[0m13:35:35.423398 [debug] [Thread-2  ]: SQL status: COMMIT in 0.05 seconds
[0m13:35:35.423671 [debug] [Thread-2  ]: Using redshift connection "model.rs_dbt_country.filter_countries_data_by_date"
[0m13:35:35.423794 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: BEGIN
[0m13:35:35.425521 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
[0m13:35:35.426290 [debug] [Thread-2  ]: finished collecting timing info
[0m13:35:35.426475 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: ROLLBACK
[0m13:35:35.427850 [debug] [Thread-2  ]: On model.rs_dbt_country.filter_countries_data_by_date: Close
[0m13:35:35.428760 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a30487-153f-4084-b7d8-d65075f552b7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9d3fa9a60>]}
[0m13:35:35.429223 [info ] [Thread-2  ]: 3 of 3 OK created sql table model public.filter_countries_data_by_date ......... [[32mSELECT[0m in 0.22s]
[0m13:35:35.429834 [debug] [Thread-2  ]: Finished running node model.rs_dbt_country.filter_countries_data_by_date
[0m13:35:35.431585 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:35:35.431834 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:35.431960 [debug] [MainThread]: On master: BEGIN
[0m13:35:35.432074 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:35.432211 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:35.458045 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:35:35.458318 [debug] [MainThread]: On master: COMMIT
[0m13:35:35.458441 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:35.458557 [debug] [MainThread]: On master: COMMIT
[0m13:35:35.459921 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:35.460149 [debug] [MainThread]: On master: Close
[0m13:35:35.461069 [info ] [MainThread]: 
[0m13:35:35.461538 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m13:35:35.461889 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:35.462282 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_countries_by_region' was properly closed.
[0m13:35:35.462399 [debug] [MainThread]: Connection 'model.rs_dbt_country.get_relevant_details_for_countries' was properly closed.
[0m13:35:35.462508 [debug] [MainThread]: Connection 'model.rs_dbt_country.filter_countries_data_by_date' was properly closed.
[0m13:35:35.475128 [info ] [MainThread]: 
[0m13:35:35.475577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:35.475967 [info ] [MainThread]: 
[0m13:35:35.476319 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m13:35:35.476709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c18460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3c1f190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd9f3047220>]}
[0m13:35:35.476987 [debug] [MainThread]: Flushing usage events


============================== 2022-11-14 13:35:50.810000 | 3c1c5a62-2ad6-4cb6-9f45-fbe6cddcf09b ==============================
[0m13:35:50.810025 [info ] [MainThread]: Running with dbt=1.3.0
[0m13:35:50.810510 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/deepa.balwally/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
[0m13:35:50.810715 [debug] [MainThread]: Tracking: tracking
[0m13:35:50.821317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd133e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd133e910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd133e940>]}
[0m13:35:50.915731 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:35:50.915970 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:35:50.925042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c1c5a62-2ad6-4cb6-9f45-fbe6cddcf09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd113cca0>]}
[0m13:35:50.938798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c1c5a62-2ad6-4cb6-9f45-fbe6cddcf09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd121fdf0>]}
[0m13:35:50.939171 [info ] [MainThread]: Found 3 models, 1 test, 0 snapshots, 0 analyses, 524 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
[0m13:35:50.939579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1c5a62-2ad6-4cb6-9f45-fbe6cddcf09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd121fd30>]}
[0m13:35:50.941088 [info ] [MainThread]: 
[0m13:35:50.941889 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:35:50.943331 [debug] [ThreadPool]: Acquiring new redshift connection "list_braavos_public"
[0m13:35:50.960714 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:35:50.960953 [debug] [ThreadPool]: On list_braavos_public: BEGIN
[0m13:35:50.961085 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:35:50.961235 [debug] [ThreadPool]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:50.984450 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
[0m13:35:50.984720 [debug] [ThreadPool]: Using redshift connection "list_braavos_public"
[0m13:35:50.984859 [debug] [ThreadPool]: On list_braavos_public: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "list_braavos_public"} */
select
      'braavos' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'braavos' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
[0m13:35:51.022759 [debug] [ThreadPool]: SQL status: SELECT in 0.04 seconds
[0m13:35:51.037133 [debug] [ThreadPool]: On list_braavos_public: ROLLBACK
[0m13:35:51.038810 [debug] [ThreadPool]: On list_braavos_public: Close
[0m13:35:51.054753 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.054992 [debug] [MainThread]: On master: BEGIN
[0m13:35:51.055118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:35:51.055259 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:51.074012 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
[0m13:35:51.074268 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.074395 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m13:35:51.124701 [debug] [MainThread]: SQL status: SELECT in 0.05 seconds
[0m13:35:51.126391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c1c5a62-2ad6-4cb6-9f45-fbe6cddcf09b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd121f460>]}
[0m13:35:51.126738 [debug] [MainThread]: On master: ROLLBACK
[0m13:35:51.128219 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.128388 [debug] [MainThread]: On master: BEGIN
[0m13:35:51.131300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m13:35:51.131470 [debug] [MainThread]: On master: COMMIT
[0m13:35:51.131596 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.131712 [debug] [MainThread]: On master: COMMIT
[0m13:35:51.133036 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:51.133221 [debug] [MainThread]: On master: Close
[0m13:35:51.134086 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:35:51.134467 [info ] [MainThread]: 
[0m13:35:51.138964 [debug] [Thread-1  ]: Began running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:35:51.139219 [info ] [Thread-1  ]: 1 of 1 START test not_null_get_countries_by_region_region ...................... [RUN]
[0m13:35:51.140019 [debug] [Thread-1  ]: Acquiring new redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:35:51.140207 [debug] [Thread-1  ]: Began compiling node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:35:51.140359 [debug] [Thread-1  ]: Compiling test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:35:51.159998 [debug] [Thread-1  ]: Writing injected SQL for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:35:51.160465 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:51.160637 [debug] [Thread-1  ]: Began executing node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:35:51.181866 [debug] [Thread-1  ]: Writing runtime sql for node "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:35:51.182390 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:35:51.182529 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: BEGIN
[0m13:35:51.182653 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:35:51.182788 [debug] [Thread-1  ]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:51.201489 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
[0m13:35:51.201847 [debug] [Thread-1  ]: Using redshift connection "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"
[0m13:35:51.202044 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: /* {"app": "dbt", "dbt_version": "1.3.0", "profile_name": "rs_dbt_country", "target_name": "dev", "node_id": "test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select region
from "braavos"."public"."get_countries_by_region"
where region is null



      
    ) dbt_internal_test
[0m13:35:51.229048 [debug] [Thread-1  ]: SQL status: SELECT in 0.03 seconds
[0m13:35:51.231561 [debug] [Thread-1  ]: finished collecting timing info
[0m13:35:51.231800 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: ROLLBACK
[0m13:35:51.233425 [debug] [Thread-1  ]: On test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420: Close
[0m13:35:51.234314 [info ] [Thread-1  ]: 1 of 1 PASS not_null_get_countries_by_region_region ............................ [[32mPASS[0m in 0.09s]
[0m13:35:51.234859 [debug] [Thread-1  ]: Finished running node test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420
[0m13:35:51.236358 [debug] [MainThread]: Acquiring new redshift connection "master"
[0m13:35:51.236542 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.236668 [debug] [MainThread]: On master: BEGIN
[0m13:35:51.236784 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:35:51.236916 [debug] [MainThread]: Redshift adapter: Connecting to Redshift using 'database' credentials
[0m13:35:51.262268 [debug] [MainThread]: SQL status: BEGIN in 0.03 seconds
[0m13:35:51.262535 [debug] [MainThread]: On master: COMMIT
[0m13:35:51.262664 [debug] [MainThread]: Using redshift connection "master"
[0m13:35:51.262782 [debug] [MainThread]: On master: COMMIT
[0m13:35:51.264115 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m13:35:51.264288 [debug] [MainThread]: On master: Close
[0m13:35:51.265086 [info ] [MainThread]: 
[0m13:35:51.265387 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 0.32 seconds (0.32s).
[0m13:35:51.265715 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:35:51.265879 [debug] [MainThread]: Connection 'test.rs_dbt_country.not_null_get_countries_by_region_region.c9cb447420' was properly closed.
[0m13:35:51.278523 [info ] [MainThread]: 
[0m13:35:51.278892 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:35:51.279283 [info ] [MainThread]: 
[0m13:35:51.279670 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:35:51.280130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd121fb20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd0867490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fedd0842a30>]}
[0m13:35:51.280468 [debug] [MainThread]: Flushing usage events
